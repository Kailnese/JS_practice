<html>
    <head>
        <title>Snack Game</title>
        <style>
            body{
                margin: 0;
            }
            .main{
                height: 700px;
                width: 700px;
                margin: 0 auto;
                margin-top: 100px;
                border: 2px solid black;
            }
            .canvas{
                height: 700px;
                width: 500px;
                float: left;
                background-color: black;
                margin: 0;
                position: relative;
            }
            .scorePanel{
                background-color: grey;
                height: 700px;
                width: 198px;
                float: left;
                text-align: center;
                border-left: 2px solid black;
            }
            .display{
                margin-top: 100px;
            }
            .score{
                border: 2px solid black;
                width: 150px;
                margin: auto;
            }
            .food, .player{
                position: absolute;
                width: 10px;
                height: 10px;
                background-color: #169c28;
                float: left;
                border-radius: 50%;
            }
            .food{
                background-color: #fff;
            }
            .start{
                position: absolute;
                width: 100px;
                height: 50px;
                top: 50%;
                left: 50%;
                -ms-transform: translate(-50%, -50%);
                transform: translate(-50%, -50%);
            }
        </style>
    </head>
    <body>
        <div class="main">
            <div class="canvas">
                <button onclick="start()" class="start">Start</button>
            </div>
            <div class="scorePanel">
                <div class="display">
                    <h1>Score</h1>
                    <h1 class="score"><span class="num" style="color: #fff;">0</span> Points</h1>
                </div>
            </div>
        </div>

        <script>
            console.log(document.getElementsByClassName("canvas"))
            var canvas = document.getElementsByClassName("canvas")[0];
            const width = canvas.clientWidth;
            const height = canvas.clientHeight;
            /*
                left 0 - 480
                top 0 - 690
            */
            var speed = 100;
            var direction = "idle";
            var player = document.createElement("div");
            var points = document.getElementsByClassName("num")[0];
            var bodys = [];

            function generateFood(){
                var x, y;
                var hasSame = false;
                while(true){
                    x = Math.floor(Math.random()*(width-10)/10)*10;
                    y = Math.floor(Math.random()*(height-10)/10)*10;
                    for(var a = 0; a<bodys.length; a++){
                        if(Number(bodys[a].style.top.substring(0, bodys[a].style.top.length-2)) == y && Number(bodys[a].style.left.substring(0, bodys[a].style.left.length-2)) == x){
                            hasSame = true;
                            break;
                        }
                    }
                    if(!hasSame) break;
                }
                var food = document.createElement("div");
                food.className = "food";
                food.style.left = x + "px";
                food.style.top = y + "px";
                canvas.appendChild(food);
            }

            function createHead(){
                player.style.left = Math.floor(Math.random()*(width-10)/10)*10 + "px";
                player.style.top = Math.floor(Math.random()*(height-10)/10)*10 + "px";
                player.className = "player";
                canvas.appendChild(player);
            }

            function addBody(){
                var newBody = document.createElement("div");
                newBody.className = "player";
                switch(direction){
                    case "top":
                        if(bodys.length == 0){
                            newBody.style.top = Number(player.style.top.substring(0, player.style.top.length-2))+10+"px";
                            newBody.style.left = player.style.left;
                        }else{
                            newBody.style.top = Number(bodys[bodys.length-1].style.top.substring(0, bodys[bodys.length-1].style.top.length-2))+10+"px";
                            newBody.style.left = bodys[bodys.length-1].style.left;
                        }
                        break;
                    case "down":
                        if(bodys.length == 0){
                            newBody.style.top = Number(player.style.top.substring(0, player.style.top.length-2))-10+"px";
                            newBody.style.left = player.style.left;
                        }else{
                            newBody.style.top = Number(bodys[bodys.length-1].style.top.substring(0, bodys[bodys.length-1].style.top.length-2))-10+"px";
                            newBody.style.left = bodys[bodys.length-1].style.left;
                        }
                        break;
                    case "left": 
                        if(bodys.length == 0){
                            newBody.style.top = player.style.top;
                            newBody.style.left = Number(player.style.left.substring(0, player.style.left.length-2))+10+"px";
                        }else{
                            newBody.style.top = bodys[bodys.length-1].style.top;
                            newBody.style.left = Number(bodys[bodys.length-1].style.left.substring(0, bodys[bodys.length-1].style.left.length-2))+10+"px";
                        }
                        break;
                    case "right": 
                        if(bodys.length == 0){
                            newBody.style.top = player.style.top;
                            newBody.style.left = Number(player.style.left.substring(0, player.style.left.length-2))-10+"px";
                        }else{
                            newBody.style.top = bodys[bodys.length-1].style.top;
                            newBody.style.left = Number(bodys[bodys.length-1].style.left.substring(0, bodys[bodys.length-1].style.left.length-2))-10+"px";
                        }
                        break;
                }
                bodys.push(newBody);
                canvas.appendChild(newBody);
            }

            function move(){
                var x = Number(player.style.left.substring(0, player.style.left.length-2));
                var y = Number(player.style.top.substring(0, player.style.top.length-2));
                switch(direction){
                    case "top":
                        y -= 10;
                        break;
                    case "down":
                        y += 10;
                        break;
                    case "right": 
                        x += 10;
                        break;
                    case "left":
                        x -= 10;
                        break;
                    case "idle":
                        return;
                }
                for(var a = bodys.length-1; a > 0; a--){
                    bodys[a].style.top = bodys[a-1].style.top;
                    bodys[a].style.left = bodys[a-1].style.left;
                }
                if(bodys.length > 0){
                    bodys[a].style.top = player.style.top;
                    bodys[a].style.left = player.style.left;
                }
                player.style.left = x + 'px';
                player.style.top = y + 'px';
            }

            function eatFood(){
                var food = document.getElementsByClassName("food")[0];
                var food_x = Number(food.style.left.substring(0, food.style.left.length-2));
                var food_y = Number(food.style.top.substring(0, food.style.top.length-2));
                var player_x = Number(player.style.left.substring(0, player.style.left.length-2));
                var player_y = Number(player.style.top.substring(0, player.style.top.length-2));
                if(food_x == player_x && food_y == player_y){
                    points.textContent = Number(points.textContent) + 10;
                    return true;
                }
                else return false;
            }

            function start(){
                var id = null;
                clearInterval(id);
                id = setInterval(frame, speed);
                var button = document.getElementsByClassName("start")[0];
                button.style.visibility = "hidden";
                generateFood();
                createHead();
                function frame(){
                    if(gameOver()){
                        button.style.visibility = "visible";
                        var food = document.getElementsByClassName("food")[0];
                        canvas.removeChild(food);
                        for(var a = 0; a<bodys.length; a++) canvas.removeChild(bodys[a]);
                        bodys = [];
                        points.textContent = 0;
                        direction = "idle";
                        clearInterval(id);
                    }else{
                        move();
                        if(eatSelf()){
                            button.style.visibility = "visible";
                            var food = document.getElementsByClassName("food")[0];
                            canvas.removeChild(food);
                            for(var a = 0; a<bodys.length; a++) canvas.removeChild(bodys[a]);
                            bodys = [];
                            points.textContent = 0;
                            direction = "idle";
                            clearInterval(id);
                        }
                        if(eatFood()){
                            var food = document.getElementsByClassName("food")[0];
                            addBody();
                            canvas.removeChild(food);
                            generateFood();
                        }
                    }
                }
            }

            function eatSelf(){
                for(var a = 0; a<bodys.length; a++){
                    if(bodys[a].style.top == player.style.top && bodys[a].style.left == player.style.left) return true;
                }
                return false;
            }

            function gameOver(){
                if(player.style.top == "0px" || player.style.top == "690px" || player.style.left == "0px" || player.style.left == "490px"){
                    return true;
                }
                return false;
            }

            document.addEventListener('keydown', function(event){
                switch(event.key){
                    case "ArrowLeft":
                        if(bodys.length == 0) direction = "left";
                        else direction = direction == "right" ? "right" : "left";
                        break;
                    case "ArrowRight":
                        if(bodys.length == 0) direction = "right";
                        else direction = direction == "left" ? "left" : "right";
                        break;
                    case "ArrowDown":
                        if(bodys.length == 0) direction = "down";
                        else direction = direction == "top" ? "top" : "down";
                        break;
                    case "ArrowUp":
                        if(bodys.length == 0) direction = "top";
                        else direction = direction == "down" ? "down" : "top";
                        break;
                }
            });
                
        </script>
    </body>
</html>